(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-761c9d69"],{"2bfd":function(e,t,n){},"543a":function(e,t,n){"use strict";n("bb85")},7660:function(e,t,n){"use strict";n("b73f")},b73f:function(e,t,n){},bb85:function(e,t,n){},c6a6:function(e,t,n){"use strict";var a=n("5530"),r=(n("d81d"),n("4de4"),n("498a"),n("7db0"),n("caad"),n("2532"),n("2bfd"),n("b974")),i=n("8654"),s=n("d9f7"),c=n("80d2"),o=Object(a["a"])(Object(a["a"])({},r["b"]),{},{offsetY:!0,offsetOverflow:!0,transition:!1});t["a"]=r["a"].extend({name:"v-autocomplete",props:{allowOverflow:{type:Boolean,default:!0},autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:function(e,t,n){return n.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1}},hideNoData:Boolean,menuProps:{type:r["a"].options.props.menuProps.type,default:function(){return o}},noFilter:Boolean,searchInput:{type:String}},data:function(){return{lazySearch:this.searchInput}},computed:{classes:function(){return Object(a["a"])(Object(a["a"])({},r["a"].options.computed.classes.call(this)),{},{"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1})},computedItems:function(){return this.filteredItems},selectedValues:function(){var e=this;return this.selectedItems.map((function(t){return e.getValue(t)}))},hasDisplayedItems:function(){var e=this;return this.hideSelected?this.filteredItems.some((function(t){return!e.hasItem(t)})):this.filteredItems.length>0},currentRange:function(){return null==this.selectedItem?0:String(this.getText(this.selectedItem)).length},filteredItems:function(){var e=this;return!this.isSearching||this.noFilter||null==this.internalSearch?this.allItems:this.allItems.filter((function(t){var n=Object(c["n"])(t,e.itemText),a=null!=n?String(n):"";return e.filter(t,String(e.internalSearch),a)}))},internalSearch:{get:function(){return this.lazySearch},set:function(e){this.lazySearch!==e&&(this.lazySearch=e,this.$emit("update:search-input",e))}},isAnyValueAllowed:function(){return!1},isDirty:function(){return this.searchIsDirty||this.selectedItems.length>0},isSearching:function(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow:function(){return!!this.isFocused&&(this.hasDisplayedItems||!this.hideNoData)},$_menuProps:function(){var e=r["a"].options.computed.$_menuProps.call(this);return e.contentClass="v-autocomplete__content ".concat(e.contentClass||"").trim(),Object(a["a"])(Object(a["a"])({},o),e)},searchIsDirty:function(){return null!=this.internalSearch&&""!==this.internalSearch},selectedItem:function(){var e=this;return this.multiple?null:this.selectedItems.find((function(t){return e.valueComparator(e.getValue(t),e.getValue(e.internalValue))}))},listData:function(){var e=r["a"].options.computed.listData.call(this);return e.props=Object(a["a"])(Object(a["a"])({},e.props),{},{items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch}),e}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused:function(e){e?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.blur(),this.updateSelf())},isMenuActive:function(e){!e&&this.hasSlot&&(this.lazySearch=null)},items:function(e,t){t&&t.length||!this.hideNoData||!this.isFocused||this.isMenuActive||!e.length||this.activateMenu()},searchInput:function(e){this.lazySearch=e},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created:function(){this.setSearch()},destroyed:function(){document.removeEventListener("copy",this.onCopy)},methods:{onFilteredItemsChanged:function(e,t){var n=this;e!==t&&(this.setMenuIndex(-1),this.$nextTick((function(){n.internalSearch&&(1===e.length||n.autoSelectFirst)&&(n.$refs.menu.getTiles(),n.setMenuIndex(0))})))},onInternalSearchChanged:function(){this.updateMenuDimensions()},updateMenuDimensions:function(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex:function(e){this.searchIsDirty||(this.multiple&&e===c["s"].left?-1===this.selectedIndex?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&e===c["s"].right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:e!==c["s"].backspace&&e!==c["s"].delete||this.deleteCurrentItem())},deleteCurrentItem:function(){var e=this.selectedIndex,t=this.selectedItems[e];if(this.isInteractive&&!this.getDisabled(t)){var n=this.selectedItems.length-1;if(-1!==this.selectedIndex||0===n){var a=this.selectedItems.length,r=e!==a-1?e:e-1,i=this.selectedItems[r];i?this.selectItem(t):this.setValue(this.multiple?[]:null),this.selectedIndex=r}else this.selectedIndex=n}},clearableCallback:function(){this.internalSearch=null,r["a"].options.methods.clearableCallback.call(this)},genInput:function(){var e=i["a"].options.methods.genInput.call(this);return e.data=Object(s["a"])(e.data,{attrs:{"aria-activedescendant":Object(c["m"])(this.$refs.menu,"activeTile.id"),autocomplete:Object(c["m"])(e.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),e},genInputSlot:function(){var e=r["a"].options.methods.genInputSlot.call(this);return e.data.attrs.role="combobox",e},genSelections:function(){return this.hasSlot||this.multiple?r["a"].options.methods.genSelections.call(this):[]},onClick:function(e){this.isInteractive&&(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(e.target)||this.activateMenu())},onInput:function(e){if(!(this.selectedIndex>-1)&&e.target){var t=e.target,n=t.value;t.value&&this.activateMenu(),this.internalSearch=n,this.badInput=t.validity&&t.validity.badInput}},onKeyDown:function(e){var t=e.keyCode;!e.ctrlKey&&[c["s"].home,c["s"].end].includes(t)||r["a"].options.methods.onKeyDown.call(this,e),this.changeSelectedIndex(t)},onSpaceDown:function(e){},onTabDown:function(e){r["a"].options.methods.onTabDown.call(this,e),this.updateSelf()},onUpDown:function(e){e.preventDefault(),this.activateMenu()},selectItem:function(e){r["a"].options.methods.selectItem.call(this,e),this.setSearch()},setSelectedItems:function(){r["a"].options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch:function(){var e=this;this.$nextTick((function(){e.multiple&&e.internalSearch&&e.isMenuActive||(e.internalSearch=!e.selectedItems.length||e.multiple||e.hasSlot?null:e.getText(e.selectedItem))}))},updateSelf:function(){(this.searchIsDirty||this.internalValue)&&(this.valueComparator(this.internalSearch,this.getValue(this.internalValue))||this.setSearch())},hasItem:function(e){return this.selectedValues.indexOf(this.getValue(e))>-1},onCopy:function(e){var t,n;if(-1!==this.selectedIndex){var a=this.selectedItems[this.selectedIndex],r=this.getText(a);null==(t=e.clipboardData)||t.setData("text/plain",r),null==(n=e.clipboardData)||n.setData("text/vnd.vuetify.autocomplete.item+plain",r),e.preventDefault()}}}})},d2f1:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"products"},[n("v-breadcrumbs",{attrs:{items:e.links,divider:"/"}}),n("v-container",{staticClass:"my-5",attrs:{fluid:""}},[n("v-row",{staticClass:"mx-3",attrs:{wrap:""}},e._l(this.Array,(function(t){return n("v-col",{key:t.list_name,class:"list-group mx-2 "+t.list_status,attrs:{xs12:"",sm6:"",md2:"","data-cypress":"column-"+t.list_status}},[e._v(" "+e._s(t.list_name)+" "),n("br"),n("Draggable",{staticClass:"list-group list-col my-3",attrs:{list:e.cards1(t.id),group:"cards","data-cypress":"dragZone-"+t.list_status,draggable:".draggable"},on:{change:function(n){return e.cardMoved(t.id,n)}}},e._l(e.cards1(t.id),(function(a){return n("Card",{key:a.id,staticClass:"list-group-item",class:e.checkMove(a,t.id),attrs:{card:a,listId:t.id,cardComments:e.commentsByCard(a.id),team:e.team,product:e.product,"data-cypress":"card"},on:{"snackbar-Fn":e.snackbarFn}})})),1),1===t.id?n("div",{staticClass:"text-right"},[n("NewCard",{attrs:{productId:e.productId,programme:e.programme,team:e.team}})],1):e._e()],1)})),1)],1),n("v-snackbar",{attrs:{color:"primary",timeout:e.snackbar.timeout},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.attrs;return[n("v-btn",e._b({attrs:{color:"white",text:""},on:{click:function(t){e.snackbar.snackbar=!1}}},"v-btn",a,!1),[e._v(" Close ")])]}}]),model:{value:e.snackbar.snackbar,callback:function(t){e.$set(e.snackbar,"snackbar",t)},expression:"snackbar.snackbar"}},[e._v(" "+e._s("You moved a card to "+e.snackbar.newListName)+" ")])],1)},r=[],i=n("1da1"),s=n("5530"),c=(n("96cf"),n("4de4"),n("d81d"),n("b0c0"),n("7db0"),n("159b"),n("dc59")),o=n("2f62"),l=n("ae8d"),u=n("b76a"),d=n.n(u),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{scrollable:"",persistent:"","max-width":"1000","data-cypress":"addNewCardDialog"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"ma-2",attrs:{fab:"",elevation:"2",small:"",dark:"",color:"#26a69a","data-cypress":"addNewCardBtn1"}},"v-btn",r,!1),a),[n("v-icon",{attrs:{dark:""}},[e._v(" mdi-plus ")])],1)]}}]),model:{value:e.newCardDialog,callback:function(t){e.newCardDialog=t},expression:"newCardDialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline backgroundColorPrimary"},[e._v(" New Purchase Request ")]),n("v-card-text",[n("v-form",{ref:"form",staticClass:"px-3"},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{label:"Card Name",rules:e.inputRules,"data-cypress":"newCardName"},model:{value:e.newCard.name,callback:function(t){e.$set(e.newCard,"name",t)},expression:"newCard.name"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-combobox",{attrs:{label:"Supplier",rules:e.inputRules,items:this.suppliers,"item-text":"supplier_name","item-value":"supplier_name",hint:"Select Supplier or create new one","persistent-hint":"","search-input":e.search,"data-cypress":"newCardSupplier"},on:{change:e.updateSupplierInfo,"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t}},scopedSlots:e._u([{key:"no-data",fn:function(){return[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[e._v(' No results matching "'),n("strong",[e._v(e._s(e.search))]),e._v('". This supplier will be added as a new supplier. ')])],1)],1)]},proxy:!0}]),model:{value:e.newCard.supplier_name,callback:function(t){e.$set(e.newCard,"supplier_name",t)},expression:"newCard.supplier_name"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{label:"Contact Person",rules:e.inputRules,"data-cypress":"newCardContactPerson"},model:{value:e.newCard.contact_person,callback:function(t){e.$set(e.newCard,"contact_person",t)},expression:"newCard.contact_person"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{label:"Contact Number",rules:e.inputRulesConNum,"data-cypress":"newCardContactNum"},model:{value:e.newCard.contact_number,callback:function(t){e.$set(e.newCard,"contact_number",t)},expression:"newCard.contact_number"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{label:"Contact Email",rules:e.inputRulesEmail,"data-cypress":"newCardSuppEmail"},model:{value:e.newCard.supplier_email,callback:function(t){e.$set(e.newCard,"supplier_email",t)},expression:"newCard.supplier_email"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{label:"Quote Ref Number",rules:e.inputRules,"data-cypress":"newCardQuoteRef"},model:{value:e.newCard.supplier_quote_num,callback:function(t){e.$set(e.newCard,"supplier_quote_num",t)},expression:"newCard.supplier_quote_num"}})],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-text-field",{attrs:{label:"Item Description",rules:e.inputRules,counter:100,"data-cypress":"newCardItemDescrp"},model:{value:e.newCard.nano_item_description,callback:function(t){e.$set(e.newCard,"nano_item_description",t)},expression:"newCard.nano_item_description"}})],1),e._l(e.numOfLineItems,(function(t){return n("v-container",{key:t,staticClass:"padding0",attrs:{fluid:""}},[n("LineItem",{ref:"lineItems",refInFor:!0,attrs:{submitValue:e.submitValue,cardId:e.cardId,programmeId:e.programme.id,componentId:t,currencyCard:e.newCard.currency},on:{quantityTimesUnitPrice:function(t){return e.updatePrice(t)},lineItemData:function(t){return e.recieveLineItemsData(t)}}})],1)})),n("v-col",{staticClass:"padding0",attrs:{cols:"12",sm:"6",md:"6",align:"left"}},[n("p",{staticClass:"caption"},[e._v("*Add delivery cost as a line item")])]),n("v-col",{staticClass:"padding0",attrs:{cols:"12",sm:"6",md:"6",align:"right"}},[n("v-btn",{staticClass:"backgroundColorPrimary",attrs:{"x-small":"","data-cypress":"addLineItemBtn"},on:{click:function(t){e.numOfLineItems+=1}}},[e._v(" + Line Item ")]),n("v-btn",{staticClass:"backgroundColorPrimary paddingleft1rem",attrs:{"x-small":"","data-cypress":"removeLineItemBtn"},on:{click:function(t){e.numOfLineItems-=1}}},[e._v(" - Line Item ")])],1),n("v-col",{attrs:{cols:"12",sm:"2",md:"2"}},[n("v-select",{ref:"currency",attrs:{label:"Currency",items:e.currency_options,value:e.currency_options.value},on:{change:function(t){return e.updateTotal()}},model:{value:e.newCard.currency,callback:function(t){e.$set(e.newCard,"currency",t)},expression:"newCard.currency"}})],1),n("v-col",{attrs:{cols:"12",sm:"3",md:"3"}},[n("v-text-field",{attrs:{label:"Lead Time",suffix:"days",rules:e.inputRulesQuan,"data-cypress":"newCardLeadTime"},model:{value:e.newCard.lead_time,callback:function(t){e.$set(e.newCard,"lead_time",t)},expression:"newCard.lead_time"}})],1),n("v-col",{attrs:{cols:"12",sm:"7",md:"7"}},[n("v-text-field",{attrs:{label:"Payment Terms",rules:e.inputRules,"data-cypress":"newCardPaymentTerms"},model:{value:e.newCard.payment_terms,callback:function(t){e.$set(e.newCard,"payment_terms",t)},expression:"newCard.payment_terms"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"2"}},[n("v-checkbox",{attrs:{label:"Exclude "+e.nonVAT,"data-cypress":"newCardExcludeVAT"},on:{change:function(t){return e.updateTotal()}},model:{value:e.VATexclude,callback:function(t){e.VATexclude=t},expression:"VATexclude"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"2"}},[e.VATexclude?e._e():n("v-text-field",{attrs:{label:""+e.nonVAT,rules:e.inputRulesVAT,prefix:e.newCard.currency,"data-cypress":"newCardVAT"},on:{change:function(t){return e.updateTotal()}},model:{value:e.newCard.VAT,callback:function(t){e.$set(e.newCard,"VAT",t)},expression:"newCard.VAT"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[e.VATexclude?e._e():n("v-text-field",{attrs:{label:"Total Price Exc "+e.nonVAT,rules:e.inputRulesMoney,prefix:e.newCard.currency,"data-cypress":"newCardTotalExcVAT"},model:{value:e.newCard.total_exc_vat,callback:function(t){e.$set(e.newCard,"total_exc_vat",t)},expression:"newCard.total_exc_vat"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:"Total Price",rules:e.inputRulesMoney,prefix:e.newCard.currency,"data-cypress":"newCardTotalInclVAT"},model:{value:e.newCard.total_inc_vat,callback:function(t){e.$set(e.newCard,"total_inc_vat",t)},expression:"newCard.total_inc_vat"}})],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"customdropzone",options:e.dropzoneOptions,"include-styling":!1,useCustomSlot:!0},on:{"vdropzone-file-added":e.fileAdded,"vdropzone-thumbnail":e.thumbnail}},[n("div",{staticClass:"dropzone-custom-content"},[n("h3",{staticStyle:{"font-weight":"200"}},[n("v-icon",{attrs:{medium:""}},[e._v("backup")]),e._v(" Drop files here to upload ")],1)])])],1)],2)],1)],1)],1),n("v-card-actions",[n("v-spacer"),e.loading?e._e():n("v-btn",{attrs:{color:"blue-grey darken-3",text:"","data-cypress":"cancelNewCardBtn"},on:{click:function(t){e.newCardDialog=!1}}},[e._v(" Cancel ")]),n("v-btn",{attrs:{color:"blue-grey darken-3",text:"",loading:e.loading,"data-cypress":"addNewCardBtn2"},on:{click:e.submit}},[e._v(" Create ")])],1)],1)],1)},m=[],h=n("53ca"),f=(n("ac1f"),n("466d"),n("caad"),n("2532"),n("99af"),n("a9e3"),n("b680"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{"data-cypress":"lineItem"}},[n("v-col",{attrs:{cols:"12",md:"2"}},[n("v-text-field",{attrs:{label:"Item Number",rules:e.inputRules,"data-cypress":"newCardLineItemNumber"},model:{value:e.newItem.supplier_item_num,callback:function(t){e.$set(e.newItem,"supplier_item_num",t)},expression:"newItem.supplier_item_num"}})],1),n("v-col",{attrs:{cols:"12",md:"3"}},[n("v-text-field",{attrs:{label:"Item Name",rules:e.inputRules,"data-cypress":"newCardLineItemName"},model:{value:e.newItem.supplier_item_name,callback:function(t){e.$set(e.newItem,"supplier_item_name",t)},expression:"newItem.supplier_item_name"}})],1),n("v-col",{attrs:{cols:"12",md:"2"}},[n("v-text-field",{ref:"Quantity",attrs:{label:"Quantity",rules:e.inputRulesQuan,"data-cypress":"newCardLineItemQuantity"},on:{input:e.quantityTimesPrice},model:{value:e.newItem.quantity,callback:function(t){e.$set(e.newItem,"quantity",t)},expression:"newItem.quantity"}})],1),n("v-col",{attrs:{cols:"12",md:"2"}},[n("v-text-field",{ref:"UnitPrice",attrs:{label:"Unit Price Exc VAT",rules:e.inputRulesMoney,prefix:e.currency,"data-cypress":"newCardLineItemPrice"},on:{input:e.quantityTimesPrice},model:{value:e.newItem.unit_price,callback:function(t){e.$set(e.newItem,"unit_price",t)},expression:"newItem.unit_price"}})],1),n("v-col",{attrs:{cols:"12",md:"3"}},["R"==this.currency?n("v-checkbox",{ref:"ItemExcVAT",attrs:{label:"Excl Item VAT"},on:{change:e.quantityTimesPrice},model:{value:e.newItem.exc_VAT,callback:function(t){e.$set(e.newItem,"exc_VAT",t)},expression:"newItem.exc_VAT"}}):e._e()],1)],1)}),v=[],_={props:{cardId:{type:String,required:!0},componentId:{type:Number,required:!0},currencyCard:{type:String,required:!0},programmeId:{type:String,required:!0},submitValue:{type:Boolean,required:!0}},watch:{submitValue:function(){if(1==this.submitValue){var e={card_id:this.cardId,programme_id:this.programmeId,item_number:this.newItem.supplier_item_num,item_name:this.newItem.supplier_item_name,quantity:this.newItem.quantity,unit_price:this.newItem.unit_price,updatedOn:new Date,createdOn:new Date,exc_VAT:this.newItem.exc_VAT};this.$emit("lineItemData",e);var t=this.generateString(21);c["d"].collection("line_items").doc(t).set(e)}}},data:function(){return{inputRules:[function(e){return e.length>=3||"Minimum length is 3 characters"}],inputRulesMoney:[function(e){return e.match(/^\d+(?:\.\d{0,2})$/)||"Must be in the format R0.00"},function(e){return e.length>=4||"Minimum length is 3 characters"}],inputRulesQuan:[function(e){return e%1==0||"Must be a whole number"},function(e){return e.length>=1||"Required"}],newItem:{exc_VAT:!1,nano_item_description:"",nano_item_name:"",nano_item_num:"",quantity:"",supplier_item_num:"",supplier_item_name:"",unit_price:""}}},computed:{currency:function(){return this.currencyCard}},methods:{generateString:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",a=t.length,r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*a));return n},quantityTimesPrice:function(){if(this.$refs.UnitPrice.validate()&&this.$refs.Quantity.validate()){var e={componentId:this.componentId,price:Number(this.newItem.quantity)*Number(this.newItem.unit_price),exc_VAT:this.newItem.exc_VAT};this.$emit("quantityTimesUnitPrice",e)}}}},g=_,b=n("2877"),w=n("6544"),C=n.n(w),I=n("ac7c"),x=n("62ad"),y=n("0fd9"),V=n("8654"),S=Object(b["a"])(g,f,v,!1,null,null,null),T=S.exports;C()(S,{VCheckbox:I["a"],VCol:x["a"],VRow:y["a"],VTextField:V["a"]});var A=n("92c3"),k=n.n(A),D=(n("1e3f"),{name:"NewCard",components:{LineItem:T,vueDropzone:k.a},props:{productId:{type:String,required:!0},programme:{type:Object,required:!0},team:{type:Object,required:!0}},data:function(){return{submitValue:!1,numOfLineItems:1,cardId:"",search:null,newCardDialog:!1,loading:!1,inputRulesRequired:[function(e){return!!e||"Required"}],fileRules:[function(e){return!!e||"File is required"},function(e){return e&&e.length>0||"File is required"}],inputRules:[function(e){return e.length>=3||"Minimum length is 3 characters"}],inputRulesConNum:[function(e){return e.match(/^[0-9]*$/)||"Invalid contact number"},function(e){return e.length>=10||"Invalid contact number"}],inputRulesEmail:[function(e){return/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e)||"Invalid email"}],inputRulesQuan:[function(e){return e%1==0||"Must be a whole number"},function(e){return!!e||"Required"}],inputRulesMoney:[function(e){return e.match(/^\d+(?:\.\d{0,2})$/)||"Must be in the format R0.00"},function(e){return e.length>=4||"Minimum length is 3 characters"}],inputRulesVAT:[function(e){return e.match(/^\d+(?:\.\d{0,2})$/)||"Must be in the format R0.00"}],newCard:{product_id:this.productId,list_id:1,name:"",supplier_name:"",contact_person:"",contact_number:"",supplier_email:"",supplier_quote_num:"",nano_item_description:"",lead_time:"",VAT:"",total_inc_vat:"",total_exc_vat:"",files:[],updatedOn:new Date,createdOn:new Date,technical_approval:null,purchase_approval:null,procured:null,receiver_approval:!1,quality_approval:null,purchase_order:[],team:{},price:0,price_noVAT:0,payment_terms:"",currency:"R",hubdoc:!1,creator:"",PO_number:null,POP:[]},priceArray:[{componentId:0,price:0,exc_VAT:!1}],componentIdArray:[],lineItemsArray:[],VATexclude:!1,currency_options:[{text:"ZAR (R)",value:"R"},{text:"EUR(€)",value:"€"},{text:"GBP (£)",value:"£"},{text:"USD ($)",value:"$"},{text:"BRL (R$)",value:"R$"}],dropzoneOptions:{url:"https://httpbin.org/post",previewTemplate:this.template(),uploadMultiple:!0}}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(o["d"])({suppliers:function(e){var t=e.suppliers.suppliers;return t.sort()}})),Object(o["c"])(["getSuppliers","getUserProfile"])),{},{user:function(){var e=this.getUserProfile;return e},nonVAT:function(){return"R"!=this.newCard.currency?"Customs Duty":"VAT"}}),methods:{addNewSupplier:function(e,t,n,a){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function i(){var s,o,l;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(s=[],r.suppliers.forEach((function(e){s.push(e.supplier_name)})),s.includes(e)){i.next=11;break}return i.next=5,c["d"].collection("suppliers").add({});case 5:return o=i.sent,l={contact_email:t,contact_number:n,contact_person:a,createdOn:new Date,supplier_name:e,updatedOn:new Date},i.next=9,c["d"].collection("suppliers").doc(o.id).set(l);case 9:i.next=12;break;case 11:case 12:case"end":return i.stop()}}),i)})))()},fileAdded:function(e){this.newCard.files.push(e)},recieveLineItemsData:function(e){this.lineItemsArray.push(e)},submit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=26;break}return e.loading=!0,e.newCard.product_id=e.productId,t.next=5,c["d"].collection("cards").add({});case 5:return n=t.sent,e.cardId=n.id,t.next=9,c["d"].collection("products").doc(e.newCard.product_id).get();case 9:return a=t.sent,r=a.data(),r.cards.push({card_id:n.id,card_name:e.newCard.name}),t.next=14,c["d"].collection("products").doc(e.newCard.product_id).set(r);case 14:return i={contact_number:e.newCard.contact_number,contact_person:e.newCard.contact_person,createdOn:e.newCard.createdOn,creator:e.user.id,currency:e.newCard.currency,files:[],files_count:e.newCard.files.length,hubdoc:e.newCard.hubdoc,lead_time:e.newCard.lead_time,lineItems:e.lineItemsArray,list_id:e.newCard.list_id,name:e.newCard.name,nano_item_description:e.newCard.nano_item_description,payment_terms:e.newCard.payment_terms,PO_number:e.newCard.PO_number,POP:e.newCard.POP,procured:e.newCard.procured,product_id:e.newCard.product_id,purchase_approval:e.newCard.purchase_approval,purchase_order:[],quality_approval:e.newCard.quality_approval,quality_photos:[],receiver_approval:e.newCard.receiver_approval,supplier_name:e.newCard.supplier_name,supplier_email:e.newCard.supplier_email,supplier_quote_num:e.newCard.supplier_quote_num,team:e.team,technical_approval:e.newCard.technical_approval,total_exc_vat:e.newCard.total_exc_vat,total_inc_vat:e.newCard.total_inc_vat,updatedOn:e.newCard.updatedOn,VAT:e.newCard.VAT},t.next=17,c["d"].collection("cards").doc(n.id).set(i);case 17:return e.uploadfiles(e.newCard.files,n.id),t.next=20,n.update({lineItems:e.lineItemsArray});case 20:e.$emit("addNewCardToArray",i),e.addNewSupplier(e.newCard.supplier_name,e.newCard.supplier_email,e.newCard.contact_number,e.newCard.contact_person),e.submitValue=!0,e.newCard.product_id=0,e.loading=!1,e.newCardDialog=!1;case 26:case"end":return t.stop()}}),t)})))()},template:function(){return'<div class="dz-preview dz-file-preview" style="position: relative; display: inline-block; width: 100px;height: 120px;margin-left: 10px !important;padding: 8px;padding-bottom: 10px;background-color: rgba(0, 0, 0, 0.05); text-align: center; border-radius: 10px;">\n                <span data-dz-remove>\n                  <i style="transform: translate(45px, -15px);" class="material-icons">cancel</i>\n                  </span>\n                <div style="margin-top: 2px">\n                  <div class="dz-image">\n                      <div data-dz-thumbnail></div>\n                  </div>\n                  <div class="dz-details">\n                      <div class="dz-filename"><span data-dz-name></span></div>\n                  </div>\n                  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n                  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n                  <div class="dz-success-mark"><i class="fa fa-check"></i></div>\n                  <div class="dz-error-mark"><i class="fa fa-close"></i></div>\n                </div>\n            </div>\n        '},thumbnail:function(e,t){var n,a,r,i;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),r=e.previewElement.querySelectorAll("[data-dz-thumbnail-bg]"),n=0,a=r.length;n<a;n++)i=r[n],i.alt=e.name,i.style.backgroundImage='url("'+t+'")';return setTimeout(function(){return function(){return e.previewElement.classList.add("dz-image-preview")}}(),1)}},uploadfiles:function(e,t){var n=this;e.forEach((function(e){var a=e.name,r=c["j"].ref().child("Quotes/".concat(n.programme.name,"/").concat(n.productId,"/").concat(t,"/").concat(a));r.put(e)}))},updatePrice:function(e){if(this.componentIdArray.includes(e.componentId)){var t=this.priceArray.find((function(t){return t.componentId==e.componentId}));t.price=e.price,t.exc_VAT=e.exc_VAT;var n=this.priceArray.reduce((function(e,t){return e+t.price}),0),a=0;this.priceArray.forEach((function(e){1==e.exc_VAT&&(n-=e.price,a+=e.price)})),this.newCard.price=Number(n),this.newCard.price_noVAT=Number(a)}else{this.componentIdArray.push(e.componentId),this.priceArray.push({componentId:e.componentId,price:e.price,exc_VAT:e.exc_VAT});var r=this.priceArray.reduce((function(e,t){return e+t.price}),0),i=0;this.priceArray.forEach((function(e){1==e.exc_VAT&&(r-=e.price,i+=e.price)})),this.newCard.price=Number(r),this.newCard.price_noVAT=Number(i)}this.updateVat(this.newCard.price),this.updateTotal()},updateSupplierInfo:function(e){"object"==Object(h["a"])(e)&&(this.newCard.supplier_name=e.supplier_name,this.newCard.contact_person=e.contact_person,this.newCard.contact_number=e.contact_number,this.newCard.supplier_email=e.contact_email)},updateTotal:function(){this.updateVat(this.newCard.price),this.VATexclude?(this.newCard.VAT=0,this.newCard.total_exc_vat=this.newCard.price.toFixed(2),this.newCard.total_inc_vat=(parseFloat(this.newCard.price)+parseFloat(this.newCard.VAT)).toFixed(2)):(this.newCard.total_exc_vat=(parseFloat(this.newCard.price)+parseFloat(this.newCard.price_noVAT)).toFixed(2),this.newCard.total_inc_vat=(parseFloat(this.newCard.price)+parseFloat(this.newCard.price_noVAT)+parseFloat(this.newCard.VAT)).toFixed(2))},updateVat:function(e){"R"!=this.newCard.currency?this.VATexclude&&(this.newCard.VAT=0):this.VATexclude?this.newCard.VAT=0:this.newCard.VAT=(.15*e).toFixed(2)}},mounted:function(){this.$store.dispatch("getUsers"),this.$store.dispatch("getSuppliers")}}),O=D,P=(n("543a"),n("8336")),R=n("b0af"),$=n("99d9"),L=(n("d3b7"),n("25f0"),n("8a79"),n("fb6a"),n("a434"),n("2bfd"),n("b974")),F=n("c6a6"),N=n("80d2"),j=F["a"].extend({name:"v-combobox",props:{delimiters:{type:Array,default:function(){return[]}},returnObject:{type:Boolean,default:!0}},data:function(){return{editingIndex:-1}},computed:{computedCounterValue:function(){return this.multiple?this.selectedItems.length:(this.internalSearch||"").toString().length},hasSlot:function(){return L["a"].options.computed.hasSlot.call(this)||this.multiple},isAnyValueAllowed:function(){return!0},menuCanShow:function(){return!!this.isFocused&&(this.hasDisplayedItems||!!this.$slots["no-data"]&&!this.hideNoData)},searchIsDirty:function(){return null!=this.internalSearch}},methods:{onInternalSearchChanged:function(e){if(e&&this.multiple&&this.delimiters.length){var t=this.delimiters.find((function(t){return e.endsWith(t)}));null!=t&&(this.internalSearch=e.slice(0,e.length-t.length),this.updateTags())}this.updateMenuDimensions()},genInput:function(){var e=F["a"].options.methods.genInput.call(this);return delete e.data.attrs.name,e.data.on.paste=this.onPaste,e},genChipSelection:function(e,t){var n=this,a=L["a"].options.methods.genChipSelection.call(this,e,t);return this.multiple&&(a.componentOptions.listeners=Object(s["a"])(Object(s["a"])({},a.componentOptions.listeners),{},{dblclick:function(){n.editingIndex=t,n.internalSearch=n.getText(e),n.selectedIndex=-1}})),a},onChipInput:function(e){L["a"].options.methods.onChipInput.call(this,e),this.editingIndex=-1},onEnterDown:function(e){e.preventDefault(),this.getMenuIndex()>-1||this.$nextTick(this.updateSelf)},onFilteredItemsChanged:function(e,t){this.autoSelectFirst&&F["a"].options.methods.onFilteredItemsChanged.call(this,e,t)},onKeyDown:function(e){var t=e.keyCode;!e.ctrlKey&&[N["s"].home,N["s"].end].includes(t)||L["a"].options.methods.onKeyDown.call(this,e),this.multiple&&t===N["s"].left&&0===this.$refs.input.selectionStart?this.updateSelf():t===N["s"].enter&&this.onEnterDown(e),this.changeSelectedIndex(t)},onTabDown:function(e){if(this.multiple&&this.internalSearch&&-1===this.getMenuIndex())return e.preventDefault(),e.stopPropagation(),this.updateTags();F["a"].options.methods.onTabDown.call(this,e)},selectItem:function(e){this.editingIndex>-1?this.updateEditing():(F["a"].options.methods.selectItem.call(this,e),this.internalSearch&&this.multiple&&this.getText(e).toLocaleLowerCase().includes(this.internalSearch.toLocaleLowerCase())&&(this.internalSearch=null))},setSelectedItems:function(){null==this.internalValue||""===this.internalValue?this.selectedItems=[]:this.selectedItems=this.multiple?this.internalValue:[this.internalValue]},setValue:function(e){var t;L["a"].options.methods.setValue.call(this,null!=(t=e)?t:this.internalSearch)},updateEditing:function(){var e=this.internalValue.slice();e[this.editingIndex]=this.internalSearch,this.setValue(e),this.editingIndex=-1},updateCombobox:function(){if(this.searchIsDirty){this.internalSearch!==this.getText(this.internalValue)&&this.setValue();var e=Boolean(this.$scopedSlots.selection)||this.hasChips;e&&(this.internalSearch=null)}},updateSelf:function(){this.multiple?this.updateTags():this.updateCombobox()},updateTags:function(){var e=this.getMenuIndex();if(!(e<0&&!this.searchIsDirty||!this.internalSearch)){if(this.editingIndex>-1)return this.updateEditing();var t=this.selectedItems.indexOf(this.internalSearch);if(t>-1){var n=this.internalValue.slice();n.splice(t,1),this.setValue(n)}if(e>-1)return this.internalSearch=null;this.selectItem(this.internalSearch),this.internalSearch=null}},onPaste:function(e){var t;if(this.multiple&&!this.searchIsDirty){var n=null==(t=e.clipboardData)?void 0:t.getData("text/vnd.vuetify.autocomplete.item+plain");n&&-1===this.findExistingIndex(n)&&(e.preventDefault(),L["a"].options.methods.selectItem.call(this,n))}},clearableCallback:function(){this.editingIndex=-1,F["a"].options.methods.clearableCallback.call(this)}}}),q=n("a523"),E=n("169a"),M=n("4bd4"),z=n("132d"),B=n("da13"),Q=n("5d23"),U=n("2fa4"),K=Object(b["a"])(O,p,m,!1,null,"34e7684c",null),Y=K.exports;C()(K,{VBtn:P["a"],VCard:R["a"],VCardActions:$["a"],VCardText:$["c"],VCardTitle:$["d"],VCheckbox:I["a"],VCol:x["a"],VCombobox:j,VContainer:q["a"],VDialog:E["a"],VForm:M["a"],VIcon:z["a"],VListItem:B["a"],VListItemContent:Q["a"],VListItemTitle:Q["c"],VRow:y["a"],VSelect:L["a"],VSpacer:U["a"],VTextField:V["a"]});var G={name:"Products",components:{Card:l["a"],Draggable:d.a,NewCard:Y},data:function(){return{Array:[{id:1,list_name:"Quotes",list_status:"Quotes",cards:[]},{id:2,list_name:"Technical Approval",list_status:"Technical",cards:[]},{id:3,list_name:"Purchase Approval",list_status:"Purchase",cards:[]},{id:4,list_name:"Activate Purchase",list_status:"Procurement",cards:[]},{id:5,list_name:"Follow Up",list_status:"FollowUp",cards:[]},{id:6,list_name:"Quality Approval",list_status:"Quality",cards:[]}],fetchedProductId:localStorage.getItem("LS_ROUTE_KEY"),productId:localStorage.getItem("LS_ROUTE_KEY"),snackbar:{snackbar:!1,timeout:2e7,newListName:""},update:!0}},watch:{update:function(){console.log(this.update)}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(o["d"])({cards:function(e){var t=this,n=e.cards.cards,a=n.filter((function(e){return e.product_id===t.productId})),r=a.sort((function(e,t){return e.createdOn-t.createdOn}));return r.map((function(e){return t.Array[e.list_id-1].cards.push(e)})),a},comments:function(e){return e.comments.comments},notifications:function(e){return e.notifications.notifications}})),Object(o["c"])(["getProductById","getProgrammeById","getTeams","getCards"])),{},{links:function(){return void 0==this.product||void 0==this.programme?[{text:"Programmes",to:"/"}]:[{text:"Programmes",to:"/"},{text:"".concat(this.programme.name),to:"/programme/"+"".concat(this.programme.id)},{text:"".concat(this.product.name),to:"/product/"+this.product.id}]},product:function(){var e=this.getProductById(this.fetchedProductId);return e},programme:function(){var e=this.getProductById(this.fetchedProductId),t=this.getProgrammeById(e.programme.programme_id);return t},team:function(){var e=this,t=this.getTeams,n=t.filter((function(t){return t.programme.programme_id===e.programme.id}));return n[0]}}),methods:Object(s["a"])(Object(s["a"])({},Object(o["b"])(["getProducts","getProgrammes","getSuppliers","getComments","getLineItems","getNotifications"])),{},{checkMove:function(e,t){return 1===t||5===t?"draggable":void 0},cardMoved:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,i,s,o,l,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=t.added||t.moved,void 0!=r){a.next=3;break}return a.abrupt("return");case 3:if(i=r.element,void 0!=i){a.next=6;break}return a.abrupt("return");case 6:return s=c["d"].collection("cards").doc(i.id),a.next=9,s.update({list_id:e});case 9:return n.snackbar.newListName=n.Array.find((function(t){return t.id===e})).list_name,n.snackbar.snackbar=!0,o=c["d"].collection("products").doc(i.product_id),a.next=14,o.update({status:n.Array[e-1].list_status});case 14:l=["technical_approver","purchase_approver","procurer","purchase_approver"],u=l[e-2],void 0==n.team[u]?c["d"].collection("notifications").add({card_id:i.id,product:{product_name:n.product.name,product_id:n.product.id},programme:{programme_name:n.product.programme.programme_name,programme_id:n.product.programme.programme_id},user_id:i.creator,createdOn:new Date,status:n.Array[e-1].list_status}):e-2===3?(c["d"].collection("notifications").add({card_id:i.id,product:{product_name:n.product.name,product_id:n.product.id},programme:{programme_name:n.product.programme.programme_name,programme_id:n.product.programme.programme_id},user_id:i.creator,createdOn:new Date,status:n.Array[e-1].list_status}),n.team[u].users.forEach((function(t){c["d"].collection("notifications").add({card_id:i.id,product:{product_name:n.product.name,product_id:n.product.id},programme:{programme_name:n.product.programme.programme_name,programme_id:n.product.programme.programme_id},user_id:t.value,createdOn:new Date,status:n.Array[e-1].list_status})}))):n.team[u].users.forEach((function(t){c["d"].collection("notifications").add({card_id:i.id,product:{product_name:n.product.name,product_id:n.product.id},programme:{programme_name:n.product.programme.programme_name,programme_id:n.product.programme.programme_id},user_id:t.value,createdOn:new Date,status:n.Array[e-1].list_status})})),n.getNotifications;case 18:case"end":return a.stop()}}),a)})))()},commentsByCard:function(e){var t=this.comments.filter((function(t){return t.card_id===e}));return t},cards1:function(e){var t=this,n=this.getCards,a=n.filter((function(e){return e.product_id===t.productId})),r=a.filter((function(t){return t.list_id===e}));return r},snackbarFn:function(){console.log("Grandparent Hello")}}),created:function(){this.getProducts(),this.getProgrammes(),this.getSuppliers(),this.getComments(),this.$store.dispatch("getTeams"),this.getLineItems(),this.getNotifications()},mounted:function(){this.$store.dispatch("getCards")}},J=G,Z=(n("7660"),n("2bc5")),H=n("2db4"),W=Object(b["a"])(J,a,r,!1,null,"b45bf390",null);t["default"]=W.exports;C()(W,{VBreadcrumbs:Z["a"],VBtn:P["a"],VCol:x["a"],VContainer:q["a"],VRow:y["a"],VSnackbar:H["a"]})}}]);
//# sourceMappingURL=chunk-761c9d69.6a4ce72e.js.map