{"version":3,"sources":["webpack:///./src/views/Programme_board.vue?ba4c","webpack:///src/views/Programme_board.vue","webpack:///./src/views/Programme_board.vue?2871","webpack:///./src/views/Programme_board.vue?2934","webpack:///./src/views/Programme_board.vue?9d1c"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","links","_l","list","key","list_name","class","_v","_s","cards1","id","on","$event","cardMoved","card","commentsByCard","team","snackbar","timeout","scopedSlots","_u","fn","ref","_b","model","value","callback","$$v","$set","expression","staticRenderFns","name","components","data","programmeId","String","$route","params","update","Array","newListName","watch","console","log","methods","card_comments","listCards","computed","fetchedProgrammeId","fetchedId","products","programme","lists","cards","sortedCards","map","suppliers","comments","user","users","created","$store","dispatch","mounted","component","VBreadcrumbs","VBtn","VCol","VContainer","VRow","VSnackbar"],"mappings":"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","file":"js/chunk-4f56f7b4.1193a3c2.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"products\"},[_c('v-breadcrumbs',{attrs:{\"items\":_vm.links,\"divider\":\"/\"}}),_c('v-container',{staticClass:\"my-5\",attrs:{\"fluid\":\"\"}},[_c('v-row',{staticClass:\"mx-3\",attrs:{\"wrap\":\"\"}},_vm._l((this.Array),function(list){return _c('v-col',{key:list.list_name,class:(\"list-group mx-2 \" + (list.list_status)),attrs:{\"xs12\":\"\",\"sm6\":\"\",\"md2\":\"\"}},[_vm._v(\" \"+_vm._s(list.list_name)+\" \"),_c('br'),_c('Draggable',{staticClass:\"list-group list-col my-3\",attrs:{\"list\":_vm.cards1(list.id),\"group\":\"cards\"},on:{\"change\":function($event){return _vm.cardMoved(list.id, $event)}}},_vm._l((_vm.cards1(list.id)),function(card){return _c('Card',{key:card.id,staticClass:\"list-group-item\",attrs:{\"card\":card,\"listId\":list.id,\"cardComments\":_vm.commentsByCard(card.id),\"team\":_vm.team}})}),1)],1)}),1)],1),_c('v-snackbar',{attrs:{\"color\":\"primary\",\"timeout\":_vm.snackbar.timeout},scopedSlots:_vm._u([{key:\"action\",fn:function(ref){\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._b({attrs:{\"color\":\"white\",\"text\":\"\"},on:{\"click\":function($event){_vm.snackbar.snackbar = false}}},'v-btn',attrs,false),[_vm._v(\" Close \")])]}}]),model:{value:(_vm.snackbar.snackbar),callback:function ($$v) {_vm.$set(_vm.snackbar, \"snackbar\", $$v)},expression:\"snackbar.snackbar\"}},[_vm._v(\" \"+_vm._s((\"You moved a card to \" + (_vm.snackbar.newListName)))+\" \")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"products\">\n    <v-breadcrumbs :items=\"links\" divider=\"/\"> </v-breadcrumbs>\n\n    <v-container fluid class=\"my-5\">\n      <v-row class=\"mx-3\" wrap>\n        <v-col\n          xs12\n          sm6\n          md2\n          v-for=\"list in this.Array\"\n          :key=\"list.list_name\"\n          :class=\"`list-group mx-2 ${list.list_status}`\"\n        >\n          <!--Runs through the local3000 array of list populated according to the product-->\n          {{ list.list_name }}\n          <br />\n          <Draggable\n            :list=\"cards1(list.id)\"\n            class=\"list-group list-col my-3\"\n            group=\"cards\"\n            @change=\"cardMoved(list.id, $event)\"\n          >\n            <!--Makes the child component draggable. Require :list and group properties to work.-->\n            <Card\n              v-for=\"card in cards1(list.id)\"\n              :key=\"card.id\"\n              class=\"list-group-item\"\n              :card=\"card\"\n              :listId=\"list.id\"\n              :cardComments=\"commentsByCard(card.id)\"\n              :team=\"team\"\n            ></Card>\n          </Draggable>\n        </v-col>\n      </v-row>\n    </v-container>\n    <v-snackbar\n      v-model=\"snackbar.snackbar\"\n      color=\"primary\"\n      :timeout=\"snackbar.timeout\"\n    >\n      {{ `You moved a card to ${snackbar.newListName}` }}\n\n      <template v-slot:action=\"{ attrs }\">\n        <v-btn\n          color=\"white\"\n          text\n          v-bind=\"attrs\"\n          @click=\"snackbar.snackbar = false\"\n        >\n          Close\n        </v-btn>\n      </template>\n    </v-snackbar>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport Draggable from \"vuedraggable\";\nimport Card from \"@/components/Card.vue\";\nimport { db } from \"@/firebase\";\n\nexport default {\n  name: \"Products\",\n  components: { Draggable, Card },\n  data() {\n    return {\n      programmeId: String(this.$route.params.id),\n      update: true,\n      Array: [\n        // Updates this data according to products page you on\n        {\n          id: 1,\n          list_name: \"Quotes\",\n          list_status: \"Quotes\",\n          cards: [],\n        },\n        {\n          id: 2,\n          list_name: \"Technical Approval\",\n\n          list_status: \"Technical\",\n          cards: [],\n        },\n        {\n          id: 3,\n          list_name: \"Purchase Approval\",\n\n          list_status: \"Purchase\",\n          cards: [],\n        },\n        {\n          id: 4,\n          list_name: \"Purchasing\",\n\n          list_status: \"Procurement\",\n          cards: [],\n        },\n        {\n          id: 5,\n          list_name: \"Awaiting Delivery\",\n          list_status: \"Waiting\",\n          cards: [],\n        },\n        {\n          id: 6,\n          list_name: \"Quality Approval\",\n\n          list_status: \"Quality\",\n          cards: [],\n        },\n      ],\n      snackbar: {\n        snackbar: false,\n        timeout: 20000000,\n        newListName: \"\", //This is provided by cardMoved function\n      },\n    };\n  },\n\n  watch: {\n    update: function() {\n      console.log(this.update);\n    },\n  },\n\n  methods: {\n    async cardMoved(listId, e) {\n      const evt = e.added || e.moved; //the events triggered by draggable\n      if (evt == undefined) {\n        return;\n      }\n      const card = evt.element; // these to if statements prevent stupid errors to occur\n      if (card == undefined) {\n        return;\n      }\n\n      const fbCard = db.collection(\"cards\").doc(card.id); // gets the firebase card\n      await fbCard.update({ list_id: listId }); // updates the list id on the firebase card\n\n      this.snackbar.newListName = this.Array.find(\n        // set the name for the snackbar to show where card moved to\n        (list) => list.id === listId\n      ).list_name;\n      this.snackbar.snackbar = true;\n\n      const fbProduct = db.collection(\"products\").doc(card.product_id);\n      await fbProduct.update({\n        status: this.Array[listId - 1].list_status,\n      });\n\n      const person_array = [\n        \"technical_approver\",\n        \"purchase_approver\",\n        \"procurer\",\n        \"quality_approver\",\n      ];\n      const toCall = person_array[listId - 2];\n\n      const product = this.products.find(\n        (product) => product.id === card.product_id\n      );\n\n      if (this.team[toCall] == undefined) {\n        db.collection(\"notifications\").add({\n          card_id: card.id,\n          product: {\n            product_name: product.name,\n            product_id: product.id,\n          },\n          programme: {\n            programme_name: product.programme.programme_name,\n            programme_id: product.programme.programme_id,\n          },\n          user_id: card.creator,\n          createdOn: new Date(),\n          status: this.Array[listId - 1].list_status,\n        });\n      } else {\n        this.team[toCall].users.forEach((notify) => {\n          db.collection(\"notifications\").add({\n            card_id: card.id,\n            product: {\n              product_name: product.name,\n              product_id: product.id,\n            },\n            programme: {\n              programme_name: product.programme.programme_name,\n              programme_id: product.programme.programme_id,\n            },\n            user_id: notify.value,\n            createdOn: new Date(),\n            status: this.Array[listId - 1].list_status,\n          });\n        });\n      }\n\n      this.$store.dispatch(\"getNotifications\");\n    },\n\n    commentsByCard(cardId) {\n      let card_comments = this.comments.filter(\n        (comment) => comment.card_id === cardId\n      );\n      return card_comments;\n    },\n\n    cards1(id) {\n      let listCards = this.cards.filter((card) => card.list_id === id);\n      return listCards;\n    },\n  },\n\n  computed: {\n    fetchedProgrammeId() {\n      let fetchedId = this.$route.params.id;\n      return fetchedId;\n    },\n\n    products() {\n      let products = this.$store.getters.getProducts;\n      return products;\n    },\n\n    programme() {\n      let programme = this.$store.getters.getProgrammeById(\n        this.fetchedProgrammeId\n      );\n      return programme;\n    },\n    lists() {\n      let lists = this.$store.getters.getLists;\n      return lists;\n    },\n    cards() {\n      let cards = this.$store.getters.getCardsByProgrammeId(this.programme.id);\n      let sortedCards = cards.sort((a, b) => a.createdOn - b.createdOn);\n      // //This method is to populate lists.cards of Array\n      sortedCards.map((card) => this.Array[card.list_id - 1].cards.push(card));\n      return cards;\n    },\n\n    suppliers() {\n      let suppliers = this.$store.getters.getSuppliers;\n      return suppliers;\n    },\n    comments() {\n      let comments = this.$store.getters.getComments;\n      return comments;\n    },\n    team() {\n      let team = this.$store.getters.getTeamsByProgrammeId(this.programme.id);\n      return team;\n    },\n    user() {\n      let user = this.$store.getters.getUserProfile;\n      return user;\n    },\n    users() {\n      let users = this.$store.getters.getUserProfile;\n      return users;\n    },\n    links() {\n      return [\n        {\n          text: \"Programmes\",\n          to: \"/\",\n        },\n        {\n          text: `${this.programme.name}`,\n          to: \"/programme/\" + `${this.programme.id}`,\n        },\n      ];\n    },\n  },\n  created() {\n    //Methods run before page load complete so that data available in store but also local3000ly in component\n    this.$store.dispatch(\"getProducts\");\n    this.$store.dispatch(\"getProgrammes\");\n    this.$store.dispatch(\"getLists\");\n    this.$store.dispatch(\"getSuppliers\");\n    this.$store.dispatch(\"getComments\");\n    this.$store.dispatch(\"getTeams\");\n    this.$store.dispatch(\"getLineItems\");\n  },\n\n  mounted() {\n    this.$store.dispatch(\"getCards\");\n  },\n};\n</script>\n\n<style scoped>\n.col {\n  font-weight: 300;\n  background-color: white;\n  border-radius: 2%;\n  color: grey;\n}\n.col.Quotes {\n  border-top: 4px solid #26a69a;\n}\n\n.col.Technical {\n  border-top: 4px solid #f8d04d;\n}\n\n.col.Purchase {\n  border-top: 4px solid orange;\n}\n\n.col.Procurement {\n  border-top: 4px solid tomato;\n}\n\n.col.Waiting {\n  border-top: 4px solid #9ccc65;\n}\n\n.col.Quality {\n  border-top: 4px solid #5c6bc0;\n}\n\n.list-col {\n  min-height: 500px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Programme_board.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Programme_board.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Programme_board.vue?vue&type=template&id=1eba3032&scoped=true&\"\nimport script from \"./Programme_board.vue?vue&type=script&lang=js&\"\nexport * from \"./Programme_board.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Programme_board.vue?vue&type=style&index=0&id=1eba3032&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1eba3032\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBreadcrumbs } from 'vuetify/lib/components/VBreadcrumbs';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSnackbar } from 'vuetify/lib/components/VSnackbar';\ninstallComponents(component, {VBreadcrumbs,VBtn,VCol,VContainer,VRow,VSnackbar})\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Programme_board.vue?vue&type=style&index=0&id=1eba3032&scoped=true&lang=css&\""],"sourceRoot":""}